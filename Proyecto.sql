-- -----------------------------------------------------
-- Table User
-- -----------------------------------------------------
DROP TABLE User_;
CREATE TABLE User_ (
  iduser INTEGER GENERATED BY DEFAULT AS IDENTITY,
  name VARCHAR(45) NULL,
  username VARCHAR(45) NULL,
  password VARCHAR(45) NULL,
  PRIMARY KEY (iduser))

-- -----------------------------------------------------
-- Table Friend
-- -----------------------------------------------------
DROP TABLE Friend_;
CREATE TABLE Friend (
  idfriend INTEGER GENERATED BY DEFAULT AS IDENTITY,
  iduser INT,
  idfriend1 INT,
  PRIMARY KEY (idfriend),
  CONSTRAINT fk_Amigo_Usuario
  FOREIGN KEY (iduser) 
  REFERENCES User_ (iduser),
  CONSTRAINT fk_Friend_User1
  FOREIGN KEY (idfriend1) REFERENCES User_ (iduser))


-- -----------------------------------------------------
-- Table Publication
-- -----------------------------------------------------
CREATE TABLE Publication (
  idpublication INTEGER GENERATED BY DEFAULT AS IDENTITY,
  text VARCHAR(45) NULL,
  iduser INT NOT NULL,
  PRIMARY KEY (idpublication),
  CONSTRAINT fk_Publication_User1
    FOREIGN KEY (iduser)
    REFERENCES User_ (iduser))


-- -----------------------------------------------------
-- Table Tags
-- -----------------------------------------------------
CREATE TABLE Tags (
  idtags INTEGER GENERATED BY DEFAULT AS IDENTITY,
  tag VARCHAR(45) NULL,
  idpublication INT NOT NULL,
  PRIMARY KEY (idtags),
  CONSTRAINT fk_Tags_Publication1
    FOREIGN KEY (idpublication)
    REFERENCES Publication (idpublication))


-- -----------------------------------------------------
-- Table Message
-- -----------------------------------------------------
CREATE TABLE Message (
  idmessage INTEGER GENERATED BY DEFAULT AS IDENTITY,
  message VARCHAR(45) NULL,
  iduser1 INT NOT NULL,
  iduser2 INT NOT NULL,
  PRIMARY KEY (idmessage),
  CONSTRAINT fk_Message_User1
    FOREIGN KEY (iduser1)
    REFERENCES User_ (iduser),
  CONSTRAINT fk_Message_User2
    FOREIGN KEY (iduser2)
    REFERENCES User_ (iduser))


-- -----------------------------------------------------
-- Table Friend_Request
-- -----------------------------------------------------
CREATE TABLE Friend_Request (
  idrequest INTEGER GENERATED BY DEFAULT AS IDENTITY,
  iduser1 INT NOT NULL,
  iduser2 INT NOT NULL,
  PRIMARY KEY (idrequest),
  CONSTRAINT fk_Friend_Request_User1
    FOREIGN KEY (iduser1)
    REFERENCES User_ (iduser),
  CONSTRAINT fk_Friend_Request_User2
    FOREIGN KEY (iduser2)
    REFERENCES User_ (iduser))
    
INSERT INTO USER_(name,username,password) VALUES ('Diego Obin','DiiAns','holamundo1234');
INSERT INTO USER_(name,username,password) VALUES ('Jose Obin','YeNios','1234holamundo');
INSERT INTO USER_(name,username,password) VALUES ('Juan Obin','JcMarro','hola1234mundo');
COMMIT;

SELECT * FROM USER_;
TRUNCATE TABLE USER_;
UPDATE USER_ SET name='Andres'
WHERE iduser=1;


